[include macros.cfg]
[include mainsail.cfg]
[include moonraker_obico_macros.cfg]
[include leds.cfg]
[include steppers.cfg]
[include eddy.cfg]
#[include adxl.cfg]

[mcu CB2]
serial: /tmp/klipper_host_mcu

[mcu]
canbus_uuid: 180ac67ddbf9

[mcu ebb36]
canbus_uuid: 58d36d4c9c89

[exclude_object]

[filament_motion_sensor encoder_sensor]
switch_pin: ^PC15
detection_length: 3.88 # accuracy of motion sensor 2.88mm
extruder: extruder
pause_on_runout: False
runout_gcode:
  SET_IDLE_TIMEOUT TIMEOUT=7200
  PAUSE X=0 Y=0
  M117 Filament encoder runout
  RESPOND TYPE=error MSG='Filament encoder runout'
insert_gcode:
  M117 Filament encoder inserted

[filament_switch_sensor switch_sensor]
switch_pin: ^PF0
pause_on_runout: False
runout_gcode:
  SET_IDLE_TIMEOUT TIMEOUT=7200
  PAUSE X=0 Y=0
  M117 Filament switch runout
  RESPOND TYPE=error MSG='Filament switch runout'
insert_gcode:
  M117 Filament switch inserted
  
[pause_resume]

[fan_generic CB2]
pin: PA6
tachometer_pin: PC2

[delayed_gcode start_fan_at_startup]
initial_duration: 1.
gcode:
  SET_FAN_SPEED FAN=CB2 SPEED=1.0
  STATUS_READY

[printer]
kinematics: none
max_velocity: 1
max_accel: 1

[temperature_sensor CB2]
sensor_type: temperature_host
min_temp: 10
max_temp: 100

[temperature_sensor MCU]
sensor_type: temperature_mcu
min_temp: 0
max_temp: 100

[force_move]
enable_force_move: true

[exclude_object]

[gcode_arcs]

[respond]

[extruder]
step_pin: ebb36: PD0
dir_pin: !ebb36: PD1
enable_pin: !ebb36: PD2
microsteps: 16
rotation_distance: 22.67895 #for 5mm Shaft Driven Bondtech gearsets
gear_ratio: 5:1 #Sherpa Mini uses 5:1, Folded Ascender Use 40:1 or 20:1
full_steps_per_rotation: 200 #1.8 deg motor
nozzle_diameter: 0.4
filament_diameter: 1.75
heater_pin: ebb36: PB13
sensor_type: ATC Semitec 104NT-4-R025H42G
sensor_pin: ebb36: PA3
#control: pid
#pid_Kp: 32.967
#pid_Ki: 15.699
#pid_Kd: 17.308
min_temp: 0
max_temp: 300
min_extrude_temp: 0
max_extrude_only_distance: 101

[tmc2209 extruder]
uart_pin: ebb36: PA15
run_current: 0.5
stealthchop_threshold: 0

[fan]
pin: ebb36: PA1

[fan_generic filter1]
pin: PA0

[fan_generic filter2]
pin: PA1

[temperature_sensor chamber]
sensor_type: Generic 3950
sensor_pin: PB0

[heater_fan hotend_fan]
pin: ebb36: PA0
heater: extruder
heater_temp: 40.0

[led lampje]
white_pin: PF7
cycle_time: 0.001
initial_WHITE: 0.8

[printer]
kinematics: cartesian
max_velocity: 300
max_accel:  3000
max_z_velocity: 5
max_z_accel: 100

[heater_bed]
heater_pin: PF5
sensor_pin: PB1
sensor_type: Generic 3950
#control: watermark
min_temp: 0
max_temp: 130

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 46.180
#*# pid_ki = 15.394
#*# pid_kd = 34.635
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 65.657
#*# pid_ki = 0.902
#*# pid_kd = 1194.133
#*#
#*# [input_shaper]
#*# shaper_type_x = zv
#*# shaper_freq_x = 24.2
#*# shaper_type_y = 2hump_ei
#*# shaper_freq_y = 53.0
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	0.797750, 0.747203, 0.699715, 0.671824, 0.652224, 0.626349, 0.581379, 0.545141, 0.505713, 0.473769, 0.437360, 0.401600, 0.352950, 0.303482, 0.251953, 0.197121, 0.164992, 0.125740, 0.083574, 0.038944
#*# 	0.728060, 0.649183, 0.616025, 0.582256, 0.558170, 0.529065, 0.496388, 0.471966, 0.443403, 0.412861, 0.376787, 0.344410, 0.311948, 0.258749, 0.217568, 0.172135, 0.129549, 0.084912, 0.067422, 0.029913
#*# 	0.612454, 0.590843, 0.552615, 0.530341, 0.518240, 0.504889, 0.477013, 0.457799, 0.428042, 0.397846, 0.376787, 0.351199, 0.317002, 0.278557, 0.235836, 0.196553, 0.169353, 0.136671, 0.099440, 0.068811
#*# 	0.593728, 0.518390, 0.491287, 0.469685, 0.456828, 0.439868, 0.411017, 0.400741, 0.376269, 0.353989, 0.327911, 0.308897, 0.280410, 0.242426, 0.209863, 0.173979, 0.133860, 0.100269, 0.100823, 0.067884
#*# 	0.509166, 0.482731, 0.453050, 0.429979, 0.438627, 0.431194, 0.406533, 0.392913, 0.374030, 0.350161, 0.331861, 0.311246, 0.284881, 0.255644, 0.224049, 0.193312, 0.166357, 0.140634, 0.119799, 0.087217
#*# 	0.515716, 0.425017, 0.403508, 0.379932, 0.373090, 0.362680, 0.346587, 0.344042, 0.326875, 0.302238, 0.286698, 0.265714, 0.254551, 0.214937, 0.196160, 0.163746, 0.137443, 0.108524, 0.109907, 0.093813
#*# 	0.432194, 0.399723, 0.364593, 0.350875, 0.357652, 0.362517, 0.344198, 0.337450, 0.323462, 0.297732, 0.290835, 0.273847, 0.256018, 0.227721, 0.199834, 0.179970, 0.156256, 0.135855, 0.114855, 0.091737
#*# 	0.416999, 0.337984, 0.316889, 0.300589, 0.302944, 0.291743, 0.286328, 0.281450, 0.271565, 0.257488, 0.241335, 0.226367, 0.213581, 0.194279, 0.175517, 0.145379, 0.122610, 0.093628, 0.095612, 0.083576
#*# 	0.325033, 0.315528, 0.291337, 0.279466, 0.284511, 0.295007, 0.278390, 0.279131, 0.261310, 0.247792, 0.239697, 0.229037, 0.213365, 0.195848, 0.171195, 0.157795, 0.141571, 0.116078, 0.093674, 0.085373
#*# 	0.311245, 0.249223, 0.239527, 0.231638, 0.235667, 0.229431, 0.220075, 0.231260, 0.217745, 0.205353, 0.185404, 0.186731, 0.181680, 0.164899, 0.145560, 0.126920, 0.108525, 0.083527, 0.072274, 0.081959
#*# 	0.211263, 0.224441, 0.197136, 0.201719, 0.208593, 0.223302, 0.214151, 0.211480, 0.205745, 0.195807, 0.195197, 0.185789, 0.179798, 0.175092, 0.153219, 0.137398, 0.117439, 0.103637, 0.094413, 0.078915
#*# 	0.200973, 0.148693, 0.145561, 0.141615, 0.150133, 0.153433, 0.155143, 0.151591, 0.146923, 0.139395, 0.136853, 0.137489, 0.145788, 0.136037, 0.124743, 0.094828, 0.078363, 0.055290, 0.067469, 0.085557
#*# 	0.102897, 0.122610, 0.115669, 0.107879, 0.134086, 0.155699, 0.142976, 0.146333, 0.143609, 0.144564, 0.146784, 0.151033, 0.147149, 0.144928, 0.128143, 0.120388, 0.108940, 0.093583, 0.085742, 0.079146
#*# 	0.080161, 0.037138, 0.045982, 0.048669, 0.059735, 0.063393, 0.076840, 0.083343, 0.086341, 0.084588, 0.094782, 0.097041, 0.103637, 0.096026, 0.094412, 0.090770, 0.072736, 0.055474, 0.065431, 0.088140
#*# 	-0.029730, -0.001909, -0.006045, 0.009887, 0.030703, 0.056725, 0.062977, 0.073059, 0.083574, 0.087217, 0.099439, 0.108895, 0.115124, 0.114855, 0.111134, 0.119827, 0.104282, 0.104052, 0.099438, 0.097179
#*# 	-0.070924, -0.102578, -0.088538, -0.068383, -0.048199, -0.028883, -0.017231, 0.007142, 0.016000, 0.028804, 0.038329, 0.054734, 0.070661, 0.072276, 0.074904, 0.074903, 0.071261, 0.064644, 0.082559, 0.110455
#*# 	-0.203563, -0.160141, -0.154403, -0.123923, -0.083797, -0.048758, -0.032833, -0.012058, 0.006133, 0.012277, 0.043205, 0.063209, 0.080899, 0.086341, 0.092844, 0.100269, 0.104097, 0.111498, 0.119435, 0.129080
#*# 	-0.282367, -0.282366, -0.250163, -0.222787, -0.190693, -0.153726, -0.133098, -0.089306, -0.062765, -0.041431, -0.024845, 0.009744, 0.033897, 0.045612, 0.063857, 0.069320, 0.076748, 0.078685, 0.118211, 0.160923
#*# 	-0.428901, -0.364433, -0.325935, -0.298172, -0.244726, -0.198068, -0.166703, -0.130333, -0.090911, -0.058623, -0.020944, 0.001704, 0.034315, 0.060985, 0.081776, 0.101237, 0.119026, 0.131726, 0.156814, 0.178472
#*# 	-0.518485, -0.507983, -0.443437, -0.392955, -0.349404, -0.303010, -0.265066, -0.213490, -0.171313, -0.123240, -0.091594, -0.048385, -0.008790, 0.027696, 0.065199, 0.082175, 0.109678, 0.129140, 0.174959, 0.232687
#*# x_count = 20
#*# y_count = 20
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.2
#*# min_x = 15.0
#*# max_x = 209.94
#*# min_y = 15.0
#*# max_y = 199.86999999999995
#*#
#*# [probe_eddy_current btt_eddy]
#*# reg_drive_current = 16
#*# calibrate =
#*# 	0.050000:3295773.773,0.090000:3294275.941,0.130000:3292771.874,
#*# 	0.170000:3291225.953,0.210000:3289748.295,0.250000:3288286.995,
#*# 	0.290000:3286852.845,0.330000:3285467.897,0.370000:3284121.952,
#*# 	0.410000:3282838.143,0.450000:3281466.009,0.490000:3280279.652,
#*# 	0.530000:3279073.629,0.570000:3277846.595,0.610000:3276677.834,
#*# 	0.650000:3275518.486,0.690000:3274383.349,0.730000:3273243.578,
#*# 	0.770000:3272221.681,0.810000:3271229.140,0.850000:3270193.523,
#*# 	0.890000:3269208.037,0.930000:3268261.592,0.970000:3267310.844,
#*# 	1.010000:3266476.101,1.050000:3265528.690,1.090000:3264612.568,
#*# 	1.130000:3263769.711,1.170000:3262911.766,1.210000:3262078.355,
#*# 	1.250000:3261279.626,1.290000:3260502.176,1.330000:3259680.456,
#*# 	1.370000:3258941.142,1.410000:3258204.173,1.450000:3257460.662,
#*# 	1.490000:3256757.714,1.530000:3256075.569,1.570000:3255368.723,
#*# 	1.610000:3254713.426,1.650000:3254070.496,1.690000:3253447.473,
#*# 	1.730000:3252827.538,1.770000:3252216.879,1.810000:3251631.491,
#*# 	1.850000:3251032.742,1.890000:3250467.719,1.930000:3249912.012,
#*# 	1.970000:3249358.537,2.010000:3248826.105,2.050000:3248280.723,
#*# 	2.090000:3247773.662,2.130000:3247286.151,2.170000:3246794.320,
#*# 	2.210000:3246309.643,2.250000:3245851.874,2.290000:3245380.965,
#*# 	2.330000:3244913.891,2.370000:3244458.255,2.410000:3244028.456,
#*# 	2.450000:3243612.153,2.490000:3243200.287,2.530000:3242741.190,
#*# 	2.570000:3242318.383,2.610000:3241922.058,2.650000:3241513.558,
#*# 	2.690000:3241132.262,2.730000:3240768.271,2.770000:3240357.833,
#*# 	2.810000:3240024.648,2.850000:3239647.687,2.890000:3239299.337,
#*# 	2.930000:3238939.346,2.970000:3238584.198,3.010000:3238257.389,
#*# 	3.050000:3237936.996,3.090000:3237574.683,3.130000:3237272.430,
#*# 	3.170000:3237012.321,3.210000:3236647.587,3.250000:3236334.654,
#*# 	3.290000:3236023.048,3.330000:3235751.258,3.370000:3235468.900,
#*# 	3.410000:3235164.755,3.450000:3234893.389,3.490000:3234627.292,
#*# 	3.530000:3234371.014,3.570000:3234101.678,3.610000:3233827.855,
#*# 	3.650000:3233612.284,3.690000:3233347.276,3.730000:3233101.247,
#*# 	3.770000:3232844.373,3.810000:3232633.224,3.850000:3232371.310,
#*# 	3.890000:3232161.597,3.930000:3231941.881,3.970000:3231723.075,
#*# 	4.010000:3231497.306,4.050000:3231302.172
