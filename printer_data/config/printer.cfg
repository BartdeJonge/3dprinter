[include macros.cfg]
[include mainsail.cfg]
[include moonraker_obico_macros.cfg]
[include leds.cfg]
[include steppers.cfg]
[include eddy.cfg]
#[include adxl.cfg]

[mcu CB2]
serial: /tmp/klipper_host_mcu

[mcu]
canbus_uuid: 180ac67ddbf9

[mcu ebb36]
canbus_uuid: 58d36d4c9c89

[exclude_object]

[filament_motion_sensor encoder_sensor]
switch_pin: ^PC15
detection_length: 3.88 # accuracy of motion sensor 2.88mm
extruder: extruder
pause_on_runout: False
runout_gcode:
  SET_IDLE_TIMEOUT TIMEOUT=7200
  PAUSE X=0 Y=0
  M117 Filament encoder runout
  RESPOND TYPE=error MSG='Filament encoder runout'
insert_gcode:
  M117 Filament encoder inserted

[filament_switch_sensor switch_sensor]
switch_pin: ^PF0
pause_on_runout: False
runout_gcode:
  SET_IDLE_TIMEOUT TIMEOUT=7200
  PAUSE X=0 Y=0
  M117 Filament switch runout
  RESPOND TYPE=error MSG='Filament switch runout'
insert_gcode:
  M117 Filament switch inserted
  
[pause_resume]

[fan_generic CB2]
pin: PA6
tachometer_pin: PC2

[delayed_gcode start_fan_at_startup]
initial_duration: 1.
gcode:
  SET_FAN_SPEED FAN=CB2 SPEED=1.0
  STATUS_READY

[printer]
kinematics: none
max_velocity: 1
max_accel: 1

[temperature_sensor CB2]
sensor_type: temperature_host
min_temp: 10
max_temp: 100

[temperature_sensor MCU]
sensor_type: temperature_mcu
min_temp: 0
max_temp: 100

[force_move]
enable_force_move: true

[exclude_object]

[gcode_arcs]

[respond]

[extruder]
step_pin: ebb36: PD0
dir_pin: !ebb36: PD1
enable_pin: !ebb36: PD2
microsteps: 16
rotation_distance: 22.67895 #for 5mm Shaft Driven Bondtech gearsets
gear_ratio: 5:1 #Sherpa Mini uses 5:1, Folded Ascender Use 40:1 or 20:1
full_steps_per_rotation: 200 #1.8 deg motor
nozzle_diameter: 0.4
filament_diameter: 1.75
heater_pin: ebb36: PB13
sensor_type: ATC Semitec 104NT-4-R025H42G
sensor_pin: ebb36: PA3
#control: pid
#pid_Kp: 32.967
#pid_Ki: 15.699
#pid_Kd: 17.308
min_temp: 0
max_temp: 300
min_extrude_temp: 0
max_extrude_only_distance: 101

[tmc2209 extruder]
uart_pin: ebb36: PA15
run_current: 0.5
stealthchop_threshold: 0

[fan]
pin: ebb36: PA1

[fan_generic filter1]
pin: PA0

[fan_generic filter2]
pin: PA1

[temperature_sensor environment]
sensor_type: Generic 3950
sensor_pin: PB0

[heater_fan hotend_fan]
pin: ebb36: PA0
heater: extruder
heater_temp: 40.0

[led lampje]
white_pin: PF7
cycle_time: 0.001
initial_WHITE: 0.8

[printer]
kinematics: cartesian
max_velocity: 300
max_accel:  3000
max_z_velocity: 5
max_z_accel: 100

[heater_bed]
heater_pin: PF5
sensor_pin: PB1
sensor_type: Generic 3950
#control: watermark
min_temp: 0
max_temp: 130

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 55.977
#*# pid_ki = 13.822
#*# pid_kd = 56.675
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 65.657
#*# pid_ki = 0.902
#*# pid_kd = 1194.133
#*#
#*# [input_shaper]
#*# shaper_type_x = 2hump_ei
#*# shaper_freq_x = 72.2
#*# shaper_type_y = 2hump_ei
#*# shaper_freq_y = 53.4
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	  0.316064, 0.335106, 0.314458, 0.302071, 0.305801, 0.309232, 0.297159, 0.307080, 0.305060, 0.293022, 0.296956, 0.301462, 0.295305, 0.282729, 0.266939, 0.253046, 0.245111, 0.231053, 0.237852, 0.225797
#*# 	  0.277517, 0.287440, 0.274792, 0.261103, 0.258034, 0.267729, 0.264247, 0.266599, 0.271157, 0.274588, 0.274959, 0.270823, 0.282080, 0.261141, 0.243518, 0.232899, 0.227153, 0.204782, 0.218137, 0.217784
#*# 	  0.242840, 0.271565, 0.269028, 0.263154, 0.273512, 0.285455, 0.279298, 0.281283, 0.274254, 0.276776, 0.274637, 0.273680, 0.272103, 0.264452, 0.254682, 0.243142, 0.235836, 0.221771, 0.218531, 0.211087
#*# 	  0.248300, 0.250760, 0.241712, 0.242088, 0.241542, 0.252705, 0.249756, 0.248469, 0.247415, 0.249223, 0.256188, 0.253215, 0.256357, 0.240788, 0.228685, 0.215073, 0.203819, 0.191251, 0.203955, 0.201719
#*# 	  0.234197, 0.244647, 0.246662, 0.241710, 0.257488, 0.270823, 0.275330, 0.274959, 0.268578, 0.259503, 0.271361, 0.267561, 0.258204, 0.246624, 0.238227, 0.221377, 0.208108, 0.199264, 0.203427, 0.195983
#*# 	  0.239357, 0.249600, 0.239658, 0.230001, 0.225621, 0.231807, 0.238397, 0.238943, 0.243180, 0.240957, 0.235498, 0.233861, 0.230924, 0.215290, 0.196377, 0.188745, 0.178128, 0.160578, 0.172653, 0.174575
#*# 	  0.243895, 0.256358, 0.261611, 0.248846, 0.260275, 0.267692, 0.257318, 0.266600, 0.256527, 0.261649, 0.250259, 0.240620, 0.238265, 0.225012, 0.208593, 0.201366, 0.189731, 0.168027, 0.169524, 0.161267
#*# 	  0.250898, 0.251068, 0.243387, 0.223519, 0.228644, 0.225444, 0.230170, 0.229254, 0.223872, 0.219453, 0.208417, 0.205176, 0.209298, 0.191821, 0.179414, 0.160923, 0.150306, 0.129505, 0.130685, 0.143748
#*# 	  0.246286, 0.260218, 0.258919, 0.253628, 0.253251, 0.258956, 0.257243, 0.248639, 0.243180, 0.232353, 0.219709, 0.223479, 0.212185, 0.204606, 0.187075, 0.175303, 0.159040, 0.136125, 0.130321, 0.134814
#*# 	  0.240656, 0.244478, 0.238981, 0.223520, 0.227152, 0.230846, 0.228685, 0.221947, 0.215643, 0.201935, 0.202681, 0.192174, 0.192566, 0.179109, 0.156944, 0.136671, 0.119391, 0.090216, 0.098010, 0.116034
#*# 	  0.237137, 0.240243, 0.248846, 0.234952, 0.243432, 0.257243, 0.243556, 0.243933, 0.227112, 0.214896, 0.210910, 0.213798, 0.192703, 0.185617, 0.158695, 0.140391, 0.118029, 0.099439, 0.092429, 0.098010
#*# 	  0.234575, 0.243204, 0.231808, 0.220239, 0.214721, 0.216213, 0.202216, 0.199834, 0.190465, 0.184808, 0.177956, 0.169484, 0.168382, 0.148918, 0.130503, 0.101838, 0.080392, 0.051446, 0.057327, 0.075780
#*# 	  0.228508, 0.238604, 0.238434, 0.233107, 0.245363, 0.239904, 0.229431, 0.225975, 0.209948, 0.202858, 0.193574, 0.190466, 0.178260, 0.156297, 0.139394, 0.118845, 0.099439, 0.069274, 0.063070, 0.072275
#*# 	  0.211480, 0.216515, 0.216646, 0.204999, 0.203074, 0.205922, 0.195983, 0.185577, 0.177147, 0.174150, 0.158522, 0.154971, 0.159081, 0.127917, 0.104651, 0.089569, 0.071906, 0.038110, 0.029863, 0.060985
#*# 	  0.193665, 0.208457, 0.213011, 0.198830, 0.207846, 0.218321, 0.213011, 0.209026, 0.196987, 0.183734, 0.182965, 0.174748, 0.158442, 0.149552, 0.131275, 0.099485, 0.078117, 0.055891, 0.053114, 0.049070
#*# 	  0.169140, 0.172905, 0.171407, 0.169272, 0.178472, 0.175901, 0.171023, 0.165415, 0.163321, 0.146741, 0.152188, 0.142386, 0.138076, 0.115262, 0.095657, 0.070845, 0.053484, 0.024133, 0.036072, 0.054503
#*# 	  0.132272, 0.154202, 0.158483, 0.160365, 0.177530, 0.182025, 0.173634, 0.170425, 0.162379, 0.151934, 0.156640, 0.156084, 0.135221, 0.122974, 0.106865, 0.080347, 0.068071, 0.051726, 0.047834, 0.050428
#*# 	  0.080116, 0.093168, 0.106725, 0.104926, 0.108754, 0.117076, 0.114808, 0.113267, 0.108294, 0.112451, 0.111453, 0.099254, 0.106127, 0.088831, 0.073335, 0.055336, 0.042186, 0.018119, 0.035566, 0.057143
#*# 	  0.025001, 0.058393, 0.082145, 0.098656, 0.128688, 0.134901, 0.121794, 0.124742, 0.125013, 0.114673, 0.111271, 0.104237, 0.111723, 0.099855, 0.091369, 0.086756, 0.080454, 0.062606, 0.070061, 0.067653
#*# 	  -0.029119, 0.006325, 0.024375, 0.047465, 0.071445, 0.078317, 0.071491, 0.078178, 0.085742, 0.087217, 0.087726, 0.095028, 0.098470, 0.088185, 0.088786, 0.081960, 0.076518, 0.072875, 0.089800, 0.110907
#*# x_count = 20
#*# y_count = 20
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.2
#*# min_x = 15.0
#*# max_x = 209.94
#*# min_y = 15.0
#*# max_y = 214.88000000000005
#*#
#*# [probe_eddy_current btt_eddy]
#*# reg_drive_current = 16
#*# calibrate =
#*# 	0.050000:3295773.773,0.090000:3294275.941,0.130000:3292771.874,
#*# 	0.170000:3291225.953,0.210000:3289748.295,0.250000:3288286.995,
#*# 	0.290000:3286852.845,0.330000:3285467.897,0.370000:3284121.952,
#*# 	0.410000:3282838.143,0.450000:3281466.009,0.490000:3280279.652,
#*# 	0.530000:3279073.629,0.570000:3277846.595,0.610000:3276677.834,
#*# 	0.650000:3275518.486,0.690000:3274383.349,0.730000:3273243.578,
#*# 	0.770000:3272221.681,0.810000:3271229.140,0.850000:3270193.523,
#*# 	0.890000:3269208.037,0.930000:3268261.592,0.970000:3267310.844,
#*# 	1.010000:3266476.101,1.050000:3265528.690,1.090000:3264612.568,
#*# 	1.130000:3263769.711,1.170000:3262911.766,1.210000:3262078.355,
#*# 	1.250000:3261279.626,1.290000:3260502.176,1.330000:3259680.456,
#*# 	1.370000:3258941.142,1.410000:3258204.173,1.450000:3257460.662,
#*# 	1.490000:3256757.714,1.530000:3256075.569,1.570000:3255368.723,
#*# 	1.610000:3254713.426,1.650000:3254070.496,1.690000:3253447.473,
#*# 	1.730000:3252827.538,1.770000:3252216.879,1.810000:3251631.491,
#*# 	1.850000:3251032.742,1.890000:3250467.719,1.930000:3249912.012,
#*# 	1.970000:3249358.537,2.010000:3248826.105,2.050000:3248280.723,
#*# 	2.090000:3247773.662,2.130000:3247286.151,2.170000:3246794.320,
#*# 	2.210000:3246309.643,2.250000:3245851.874,2.290000:3245380.965,
#*# 	2.330000:3244913.891,2.370000:3244458.255,2.410000:3244028.456,
#*# 	2.450000:3243612.153,2.490000:3243200.287,2.530000:3242741.190,
#*# 	2.570000:3242318.383,2.610000:3241922.058,2.650000:3241513.558,
#*# 	2.690000:3241132.262,2.730000:3240768.271,2.770000:3240357.833,
#*# 	2.810000:3240024.648,2.850000:3239647.687,2.890000:3239299.337,
#*# 	2.930000:3238939.346,2.970000:3238584.198,3.010000:3238257.389,
#*# 	3.050000:3237936.996,3.090000:3237574.683,3.130000:3237272.430,
#*# 	3.170000:3237012.321,3.210000:3236647.587,3.250000:3236334.654,
#*# 	3.290000:3236023.048,3.330000:3235751.258,3.370000:3235468.900,
#*# 	3.410000:3235164.755,3.450000:3234893.389,3.490000:3234627.292,
#*# 	3.530000:3234371.014,3.570000:3234101.678,3.610000:3233827.855,
#*# 	3.650000:3233612.284,3.690000:3233347.276,3.730000:3233101.247,
#*# 	3.770000:3232844.373,3.810000:3232633.224,3.850000:3232371.310,
#*# 	3.890000:3232161.597,3.930000:3231941.881,3.970000:3231723.075,
#*# 	4.010000:3231497.306,4.050000:3231302.172
