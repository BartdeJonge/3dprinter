[include macros.cfg]
[include mainsail.cfg]
[include moonraker_obico_macros.cfg]
[include leds.cfg]
[include steppers.cfg]
[include eddy.cfg]
#[include adxl.cfg]

[mcu CB2]
serial: /tmp/klipper_host_mcu

[mcu]
canbus_uuid: 180ac67ddbf9

[mcu ebb36]
canbus_uuid: 58d36d4c9c89

[exclude_object]

[filament_motion_sensor encoder_sensor]
switch_pin: ^PC15
detection_length: 5.76 # accuracy of motion sensor 2.88mm
extruder: extruder
pause_on_runout: False
runout_gcode:
  SET_IDLE_TIMEOUT TIMEOUT=7200
  PAUSE X=0 Y=0
  M117 Filament encoder runout
  RESPOND TYPE=error MSG='Filament encoder runout'
insert_gcode:
  M117 Filament encoder inserted

[filament_switch_sensor switch_sensor]
switch_pin: ^PF0
pause_on_runout: False
runout_gcode:
  SET_IDLE_TIMEOUT TIMEOUT=7200
  PAUSE X=0 Y=0
  M117 Filament switch runout
  RESPOND TYPE=error MSG='Filament switch runout'
insert_gcode:
  M117 Filament switch inserted
  
[pause_resume]

[fan_generic CB2]
pin: PA6
tachometer_pin: PC2

[delayed_gcode start_fan_at_startup]
initial_duration: 1.
gcode:
  SET_FAN_SPEED FAN=CB2 SPEED=1.0
  STATUS_READY

[printer]
kinematics: none
max_velocity: 1
max_accel: 1

[temperature_sensor CB2]
sensor_type: temperature_host
min_temp: 10
max_temp: 100

[temperature_sensor MCU]
sensor_type: temperature_mcu
min_temp: 0
max_temp: 100

[force_move]
enable_force_move: true

[exclude_object]

[gcode_arcs]

[respond]

[extruder]
step_pin: ebb36: PD0
dir_pin: !ebb36: PD1
enable_pin: !ebb36: PD2
microsteps: 16
rotation_distance: 22.67895 #for 5mm Shaft Driven Bondtech gearsets
gear_ratio: 5:1 #Sherpa Mini uses 5:1, Folded Ascender Use 40:1 or 20:1
full_steps_per_rotation: 200 #1.8 deg motor
nozzle_diameter: 0.4
filament_diameter: 1.75
heater_pin: ebb36: PB13
sensor_type: ATC Semitec 104NT-4-R025H42G
sensor_pin: ebb36: PA3
#control: pid
#pid_Kp: 32.967
#pid_Ki: 15.699
#pid_Kd: 17.308
min_temp: 0
max_temp: 300
min_extrude_temp: 0
max_extrude_only_distance: 101

[tmc2209 extruder]
uart_pin: ebb36: PA15
run_current: 0.5
stealthchop_threshold: 0

[fan]
pin: ebb36: PA1

[fan_generic filter1]
pin: PA0

[fan_generic filter2]
pin: PA1

[temperature_sensor chamber]
sensor_type: Generic 3950
sensor_pin: PB0

[heater_fan hotend_fan]
pin: ebb36: PA0
heater: extruder
heater_temp: 40.0

[led lampje]
white_pin: PF7
cycle_time: 0.001
initial_WHITE: 0.8

[printer]
kinematics: cartesian
max_velocity: 300
max_accel:  3000
max_z_velocity: 5
max_z_accel: 100

[heater_bed]
heater_pin: PF5
sensor_pin: PB1
sensor_type: Generic 3950
#control: watermark
min_temp: 0
max_temp: 130

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 46.180
#*# pid_ki = 15.394
#*# pid_kd = 34.635
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 65.657
#*# pid_ki = 0.902
#*# pid_kd = 1194.133
#*#
#*# [input_shaper]
#*# shaper_type_x = zv
#*# shaper_freq_x = 23.2
#*# shaper_type_y = mzv
#*# shaper_freq_y = 40.2
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	  0.206893, 0.204549, 0.188745, 0.168494, 0.149605, 0.143097, 0.131830, 0.121828, 0.130082, 0.122620, 0.107002, 0.097328, 0.071014, 0.078947, 0.064802, 0.053271, 0.040697, 0.027730, 0.006774, -0.024457
#*# 	  0.206893, 0.179556, 0.175589, 0.151995, 0.132780, 0.138338, 0.116272, 0.116748, 0.112304, 0.102747, 0.096362, 0.096941, 0.076434, 0.055715, 0.046108, 0.032134, 0.025040, 0.019275, 0.001001, -0.048635
#*# 	  0.186663, 0.167862, 0.149128, 0.137858, 0.130082, 0.136588, 0.109516, 0.089590, 0.107005, 0.087461, 0.095391, 0.078561, 0.068992, 0.055543, 0.036504, 0.024077, 0.011387, 0.011003, -0.007074, -0.067552
#*# 	  0.173921, 0.152820, 0.132303, 0.126589, 0.106034, 0.123576, 0.088625, 0.094426, 0.096359, 0.074113, 0.084367, 0.057464, 0.053794, 0.045005, 0.022538, 0.012539, -0.004377, -0.010702, -0.037529, -0.072371
#*# 	  0.149132, 0.136113, 0.119288, 0.118600, 0.097524, 0.099072, 0.088039, 0.072755, 0.077982, 0.071980, 0.061306, 0.053271, 0.045236, 0.016192, 0.010619, 0.012931, -0.021623, -0.023837, -0.049186, -0.076959
#*# 	  0.144052, 0.127859, 0.113519, 0.114366, 0.104875, 0.095973, 0.079530, 0.088042, 0.080496, 0.057987, 0.049953, 0.038599, 0.031262, 0.006192, 0.013118, -0.004383, -0.029762, -0.039387, -0.062683, -0.084948
#*# 	  0.145637, 0.123098, 0.111036, 0.096941, 0.095391, 0.087846, 0.075854, 0.059385, 0.048729, 0.038422, 0.035978, 0.029845, 0.011387, 0.006195, -0.009640, -0.014215, -0.030871, -0.065238, -0.063027, -0.115878
#*# 	  0.133575, 0.122306, 0.101779, 0.092880, 0.074303, 0.066725, 0.056590, 0.045234, 0.046866, 0.042264, 0.013502, 0.012152, 0.023696, 0.004075, -0.011626, -0.040317, -0.055208, -0.079846, -0.076961, -0.134038
#*# 	  0.136591, 0.112301, 0.098686, 0.095976, 0.074110, 0.063229, 0.055543, 0.031788, 0.026259, 0.011384, 0.014656, -0.001687, -0.008426, -0.022729, -0.025693, -0.056059, -0.064043, -0.082737, -0.089538, -0.140958
#*# 	  0.111348, 0.111509, 0.098490, 0.080498, 0.057987, 0.062881, 0.038073, 0.047855, 0.024653, 0.012928, 0.004081, -0.004959, -0.007074, -0.028282, -0.062569, -0.068124, -0.085292, -0.117860, -0.117857, -0.156729
#*# 	  0.105841, 0.103713, 0.081461, 0.077786, 0.060431, 0.041220, 0.035104, 0.021000, 0.018699, 0.008310, -0.008999, -0.010517, -0.034386, -0.032358, -0.062518, -0.072882, -0.106387, -0.109257, -0.137304, -0.173048
#*# 	  0.107971, 0.115480, 0.089588, 0.065502, 0.057113, 0.044187, 0.030734, 0.024080, 0.011387, -0.013105, -0.016070, -0.026244, -0.029947, -0.052995, -0.069140, -0.084439, -0.108152, -0.135579, -0.149230, -0.200522
#*# 	  0.089008, 0.091136, 0.063229, 0.044185, 0.059559, 0.034229, 0.008310, 0.001387, 0.001001, -0.026801, -0.028836, -0.047154, -0.060305, -0.074811, -0.076111, -0.102192, -0.125582, -0.153070, -0.164431, -0.219160
#*# 	  0.082623, 0.089394, 0.069518, 0.055192, 0.036501, 0.048027, -0.008999, -0.007071, -0.011447, -0.033460, -0.041601, -0.053339, -0.052316, -0.078992, -0.089032, -0.117049, -0.143075, -0.165188, -0.175405, -0.218988
#*# 	  0.080495, 0.083787, 0.053269, 0.048555, 0.040343, 0.020811, 0.004467, -0.016318, -0.018657, -0.037529, -0.036798, -0.047527, -0.066420, -0.080701, -0.107942, -0.130381, -0.136149, -0.164609, -0.174226, -0.228038
#*# 	  0.071206, 0.057639, 0.057467, 0.045062, 0.016768, 0.021963, -0.009188, -0.022177, -0.024764, -0.038461, -0.056229, -0.046975, -0.058090, -0.093809, -0.118307, -0.130384, -0.159806, -0.164428, -0.189013, -0.222602
#*# 	  0.060957, 0.040517, 0.046631, 0.018885, -0.001300, -0.013112, -0.014837, -0.027727, -0.040871, -0.051977, -0.062683, -0.062518, -0.071860, -0.106834, -0.129326, -0.134038, -0.167119, -0.189013, -0.191914, -0.233471
#*# 	  0.019081, 0.034057, 0.018888, 0.007734, -0.006821, -0.030871, -0.027537, -0.050109, -0.056565, -0.069487, -0.071009, -0.081208, -0.091827, -0.100216, -0.126243, -0.142499, -0.158268, -0.177989, -0.203799, -0.240362
#*# 	  -0.016625, -0.021805, -0.024394, -0.029765, -0.038458, -0.051468, -0.065061, -0.069649, -0.078830, -0.094253, -0.081717, -0.107491, -0.102633, -0.134611, -0.141923, -0.155577, -0.169236, -0.173048, -0.175632, -0.229490
#*# 	  -0.084094, -0.089538, -0.087670, -0.091166, -0.083588, -0.094401, -0.103300, -0.106170, -0.115217, -0.117857, -0.131350, -0.137440, -0.145760, -0.154608, -0.179867, -0.204498, -0.205677, -0.189715, -0.212639, -0.228948
#*# x_count = 20
#*# y_count = 20
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.2
#*# min_x = 5.0
#*# max_x = 199.94
#*# min_y = 25.0
#*# max_y = 215.0
#*#
#*# [probe_eddy_current btt_eddy]
#*# reg_drive_current = 16
#*# calibrate =
#*# 	0.050000:3230988.864,0.090000:3230834.099,0.130000:3230539.365,
#*# 	0.170000:3230186.284,0.210000:3229842.655,0.250000:3229524.274,
#*# 	0.290000:3229195.835,0.330000:3228858.916,0.370000:3228539.731,
#*# 	0.410000:3228218.764,0.450000:3227904.733,0.490000:3227591.863,
#*# 	0.530000:3227269.247,0.570000:3227009.632,0.610000:3226707.003,
#*# 	0.650000:3226432.552,0.690000:3226139.417,0.730000:3225865.184,
#*# 	0.770000:3225600.992,0.810000:3225350.420,0.850000:3225075.645,
#*# 	0.890000:3224817.440,0.930000:3224561.416,0.970000:3224320.289,
#*# 	1.010000:3224092.931,1.050000:3223822.573,1.090000:3223625.670,
#*# 	1.130000:3223366.651,1.170000:3223159.155,1.210000:3222914.431,
#*# 	1.250000:3222692.262,1.290000:3222486.870,1.330000:3222244.112,
#*# 	1.370000:3222067.168,1.410000:3221862.286,1.450000:3221641.261,
#*# 	1.490000:3221443.483,1.530000:3221263.336,1.570000:3221056.169,
#*# 	1.610000:3220860.770,1.650000:3220676.975,1.690000:3220491.720,
#*# 	1.730000:3220314.272,1.770000:3220126.662,1.810000:3219947.255,
#*# 	1.850000:3219803.596,1.890000:3219614.579,1.930000:3219459.507,
#*# 	1.970000:3219287.755,2.010000:3219131.734,2.050000:3218969.597,
#*# 	2.090000:3218793.050,2.130000:3218657.066,2.170000:3218501.056,
#*# 	2.210000:3218373.229,2.250000:3218207.610,2.290000:3218076.931,
#*# 	2.330000:3217927.494,2.370000:3217781.543,2.410000:3217660.587,
#*# 	2.450000:3217511.019,2.490000:3217370.655,2.530000:3217237.979,
#*# 	2.570000:3217099.732,2.610000:3216992.318,2.650000:3216861.583,
#*# 	2.690000:3216731.425,2.730000:3216606.024,2.770000:3216469.114,
#*# 	2.810000:3216362.424,2.850000:3216240.095,2.890000:3216131.487,
#*# 	2.930000:3216022.203,2.970000:3215903.755,3.010000:3215808.064,
#*# 	3.050000:3215665.893,3.090000:3215586.455,3.130000:3215478.896,
#*# 	3.170000:3215372.222,3.210000:3215263.703,3.250000:3215159.311,
#*# 	3.290000:3215042.463,3.330000:3214957.650,3.370000:3214862.839,
#*# 	3.410000:3214770.327,3.450000:3214660.390,3.490000:3214557.409,
#*# 	3.530000:3214476.571,3.570000:3214372.437,3.610000:3214283.334,
#*# 	3.650000:3214213.586,3.690000:3214119.494,3.730000:3214031.531,
#*# 	3.770000:3213939.175,3.810000:3213852.592,3.850000:3213768.760,
#*# 	3.890000:3213678.323,3.930000:3213601.622,3.970000:3213536.357,
#*# 	4.010000:3213468.799,4.050000:3213380.927
